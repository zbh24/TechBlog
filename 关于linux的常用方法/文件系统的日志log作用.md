#文件系统的日志log作用

1.写文件时，是这样的如下：
```
begin_trans
...
write_data
...
log_write //写到了日志块里面，同时也更新了日志的头
commit_trans  //从日志块儿里面拷贝到数据块里，然后日志头更新为0
```

2.崩溃恢复时，recover_crash
```
read_head //从日主块儿读出头的大小
install_trans	//然后把数据从日志块儿拷贝到数据儿
log.lh.n=0	// 头更新为0
write_head	// 再写到日志块儿
```

3.几种崩溃情况
记住，我们日志的目的是保持数据的一致性，并不是什么情况都能防止。

- 如果在log_write之前崩溃，那么不用担心，因为根本没有写入硬盘，不影响数据的一致性。不过，那些数据也没有写入到硬盘，下次要重新操作
- 如果在log_write之后commit_trans没有完成之前，那么不用担心，因为下次开机时，就会recover_crash，即使有可能又重新做一遍。
- 在commit_trans之后，write_data之前，那么没事，因为没有任何影响。

这就是三种情况，这种日志的作用是保证数据的一致性，其实一和三是一种情况。
